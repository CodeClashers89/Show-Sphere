<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}ShowSphere - Book Tickets Online{% endblock %}</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Custom CSS -->
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    {% block extra_css %}{% endblock %}
</head>

<body>
    <!-- LOADER CSS -->
    <style>
        /* LOADER STYLES */
        .cinematic-loader {
            position: fixed;
            inset: 0;
            background: #F9F7FF;
            /* App Background Color */
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            /* High z-index to cover everything */
            transition: opacity 0.5s ease;
        }

        /* Ambient Glow */
        .cinematic-loader::before {
            content: "";
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(140, 82, 255, 0.1), transparent 70%);
            z-index: -1;
        }

        .loader-brand {
            text-align: center;
            color: #2D2042;
            /* Primary Text Color */
            position: relative;
            z-index: 10000;
        }

        .loader-mask {
            overflow: hidden;
        }

        .loader-brand h1 {
            font-size: 48px;
            letter-spacing: 4px;
            font-weight: 800;
            /* Bolder font for modern look */
            color: transparent;
            background: linear-gradient(135deg, #8C52FF, #00BFB2);
            /* Brand Gradient */
            -webkit-background-clip: text;
            background-clip: text;
            transform: translateY(120%);
            animation: titleUp 1.2s cubic-bezier(0.77, 0, 0.175, 1) forwards;
            margin: 0;
        }

        @keyframes titleUp {
            to {
                transform: translateY(0);
            }
        }

        .loader-brand p {
            margin-top: 10px;
            font-size: 14px;
            letter-spacing: 3px;
            color: #666;
            /* Secondary Text Color */
            opacity: 0;
            animation: fadeIn 1s ease forwards;
            animation-delay: 1s;
            text-transform: uppercase;
            font-weight: 600;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        .spotlight {
            width: 0;
            height: 3px;
            /* Slightly thicker line */
            margin: 15px auto 0;
            background: linear-gradient(90deg, transparent, #8C52FF, transparent);
            /* Purple spotlight */
            animation: grow 1.2s ease forwards;
            animation-delay: 0.8s;
            border-radius: 2px;
        }

        @keyframes grow {
            to {
                width: 120px;
            }
        }

        .cinematic-loader.exit {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.8s ease-in-out;
        }
    </style>

    <!-- LOADER HTML -->
    <div class="cinematic-loader" id="cinematicLoader">
        <div class="loader-brand">
            <div class="loader-mask">
                <h1>SHOWSPHERE</h1>
            </div>
            <div class="spotlight"></div>
            <p>BOOK · WATCH · EXPERIENCE</p>
        </div>
    </div>

    <script>
        window.addEventListener("load", () => {
            const loader = document.getElementById("cinematicLoader");

            // Lock scroll initially
            document.body.style.overflow = "hidden";

            // Start exit animation slightly faster for global navigation
            setTimeout(() => {
                loader.classList.add("exit");
            }, 1000); // 1.0s display time (faster for global)

            setTimeout(() => {
                loader.remove();
                document.body.style.overflow = "auto";
            }, 1800); // 1.0s + 0.8s transition
        });
    </script>
    <!-- Navigation -->
    {% block navbar %}
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="{% url 'booking:home' %}" style="gap: 5px;">
                <img src="{% static 'css/showspere.png' %}" alt="Logo" width="40" height="40">
                ShowSphere
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'booking:browse' %}">Movies</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'booking:browse' %}?category=events">Events</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'booking:browse' %}?category=sports">Sports</a>
                    </li>
                </ul>

                <form class="d-flex me-3" action="{% url 'booking:search' %}" method="get">
                    <input class="form-control me-2" type="search" placeholder="Search for Movies, Events..."
                        aria-label="Search" name="q">
                    <button class="btn btn-outline-light" type="submit">Search</button>
                </form>

                <div class="d-flex align-items-center">
                    {% if user.is_authenticated %}
                    <div class="dropdown">
                        <button class="btn btn-secondary dropdown-toggle" type="button" id="userDropdown"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-user-circle me-1"></i> {{ user.username }}
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                            {% if user.role == 'customer' %}
                            <li><a class="dropdown-item" href="{% url 'booking:customer_dashboard' %}">My Profile</a>
                            </li>
                            <li><a class="dropdown-item" href="{% url 'booking:my_tickets' %}">My Tickets</a></li>
                            <li><a class="dropdown-item" href="{% url 'booking:booking_history' %}">Booking History</a>
                            </li>
                            {% elif user.role == 'organizer' %}
                            <li><a class="dropdown-item" href="{% url 'booking:organizer_dashboard' %}">Organizer
                                    Dashboard</a></li>
                            <li><a class="dropdown-item" href="{% url 'booking:manage_events' %}">Manage Events</a></li>
                            {% elif user.role == 'theatre_owner' %}
                            <li><a class="dropdown-item" href="{% url 'booking:theatre_dashboard' %}">Theatre
                                    Dashboard</a></li>
                            <li><a class="dropdown-item" href="{% url 'booking:manage_movies' %}">Manage Movies</a></li>
                            {% elif user.role == 'admin' %}
                            <li><a class="dropdown-item" href="{% url 'booking:admin_dashboard' %}">Admin Panel</a></li>
                            {% endif %}
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item text-danger" href="{% url 'booking:logout' %}">Logout</a></li>
                        </ul>
                    </div>
                    {% else %}
                    <a href="{% url 'booking:login' %}" class="btn btn-primary me-2">Sign In</a>
                    <a href="{% url 'booking:customer_register' %}" class="btn btn-outline-light">Sign Up</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </nav>
    {% endblock %}

    <!-- Messages -->
    {% if messages %}
    <div class="container mt-3">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Main Content -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="{% static 'css/showspere.png' %}" alt="ShowSphere Logo" width="50" height="50"
                    fetchpriority="high" loading="eager">
                ShowSphere
            </div>

            <div class="social-links">
                <a href="https://www.facebook.com" target="_blank" class="social-circle"><i
                        class="fab fa-facebook-f"></i></a>
                <a href="https://www.linkedin.com" target="_blank" class="social-circle"><i
                        class="fab fa-linkedin-in"></i></a>
                <a href="https://www.twitter.com" target="_blank" class="social-circle"><i
                        class="fab fa-twitter"></i></a>
                <a href="https://www.instagram.com" target="_blank" class="social-circle"><i
                        class="fab fa-instagram"></i></a>
            </div>

            <p class="footer-text">
                Copyright {% now "Y" %} @ ShowSphere Entertainment Pvt. Ltd. All Rights Reserved.
                <br><br>
                The content and images used on this site are copyright protected and copyrights vests with the
                respective owners. The usage of the content and images on this website is intended to promote the works
                and endorsement of the artist shall be implied. Unauthorized use is prohibited and punishable by law.
            </p>
        </div>
    </footer>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'js/main.js' %}"></script>
    {% block extra_js %}{% endblock %}
</body>

</html>