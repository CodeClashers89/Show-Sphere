<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>{{ movie.title }} | ShowSphere</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        :root {
            --primary-color: #8C52FF;
            --primary-hover: #7b40f2;
            --text-color: #2D2042;
            --text-light: #666;
            --bg-color: #F9F7FF;
            --white: #fff;
            --radius: 20px;
            --shadow: 0 10px 25px rgba(140, 82, 255, .15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }

        body {
            background: var(--bg-color);
            color: var(--text-color);
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        /* HEADER */
        .header {
            background: var(--white);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, .05);
            z-index: 100;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .logo span {
            color: var(--primary-color);
        }

        .search-bar form {
            display: flex;
        }

        .search-bar input {
            padding: .6rem 1rem;
            width: 350px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .btn {
            padding: .5rem 1.5rem;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-weight: 500;
        }

        .btn-primary {
            background: var(--primary-color);
            color: #fff;
        }

        .btn-primary:hover {
            background: var(--primary-hover);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid #ddd;
        }

        .auth-buttons {
            display: flex;
            gap: 1rem;
        }

        .footer {
            background-color: #1f2533;
            color: #abb2bf;
            padding: 5rem 2rem 3rem;
            margin-top: 5rem;
        }

        .footer-content {
            max-width: 1240px;
            margin: 0 auto;
        }

        .footer-logo {
            color: white;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .social-links {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 3rem;
            justify-content: center;
        }

        .social-circle {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: #2d3139;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            transition: all 0.3s;
        }

        .social-circle:hover {
            background: var(--primary-color);
            transform: translateY(-3px);
            color: white;
            box-shadow: 0 5px 15px rgba(140, 82, 255, 0.4);
        }

        .footer-text {
            text-align: center;
            font-size: 0.9rem;
            line-height: 1.8;
            border-top: 1px solid #2d3139;
            padding-top: 3rem;
        }

        /* NAV */
        .nav-bar {
            background: linear-gradient(135deg, #8C52FF, #00BFB2);
            padding: 1rem;
            color: white;
        }

        .nav-links {
            display: flex;
            justify-content: center;
            gap: 3rem;
            list-style: none;
        }

        /* MAIN */
        .detail-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .detail-top {
            display: flex;
            gap: 2rem;
            background: var(--white);
            padding: 2rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            flex-wrap: wrap;
        }

        .poster {
            flex: 2;
            min-width: 300px;
            height: 400px;
            border-radius: 12px;
            overflow: hidden;
            background: #222;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .poster img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .movie-info {
            flex: 1;
            min-width: 250px;
        }

        .movie-info h1 {
            font-size: 2.2rem;
            margin-bottom: .5rem;
        }

        .meta {
            margin: .8rem 0;
            color: var(--text-light);
        }

        .rating {
            background: gold;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
            margin-right: .5rem;
        }

        .book-btn {
            margin-top: 1rem;
            width: 100%;
            padding: 1rem;
            font-size: 1.1rem;
            background: var(--primary-color);
            color: white;
            border-radius: 12px;
            border: none;
            cursor: pointer;
        }

        .section {
            background: var(--white);
            padding: 2rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .section h2 {
            margin-bottom: 1rem;
        }

        .shows .date {
            margin-top: 1rem;
            font-weight: bold;
        }

        .show-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: .7rem 0;
            border-bottom: 1px solid #eee;
        }

        .show-item a {
            padding: .4rem 1rem;
            border: 1px solid #28a745;
            color: #28a745;
            border-radius: 4px;
            font-size: .9rem;
        }

        /* FOOTER */
        .footer {
            background-color: #1f2533;
            color: #abb2bf;
            padding: 5rem 2rem 3rem;
            margin-top: 5rem;
        }

        @media(max-width:768px) {
            .detail-top {
                flex-direction: column;
            }

            .poster {
                height: 250px;
            }
        }
    </style>
</head>

<body>

    <!-- HEADER -->
    <header class="header">
        <a href="{% url 'booking:home' %}" class="logo">Show<span>Sphere</span></a>

        <div class="search-bar">
            <form action="{% url 'booking:search' %}" method="get">
                <input type="text" name="q" placeholder="Search movies, events..." value="{{ request.GET.q }}">
            </form>
        </div>

        <div class="auth-buttons">
            {% if user.is_authenticated %}
            {% if user.role == 'customer' %}
            <a href="{% url 'booking:customer_dashboard' %}" class="btn btn-outline">Profile</a>
            {% elif user.role == 'organizer' %}
            <a href="{% url 'booking:organizer_dashboard' %}" class="btn btn-outline">Dashboard</a>
            {% elif user.role == 'theatre_owner' %}
            <a href="{% url 'booking:theatre_dashboard' %}" class="btn btn-outline">Dashboard</a>
            {% elif user.role == 'admin' %}
            <a href="{% url 'booking:admin_dashboard' %}" class="btn btn-outline">Admin</a>
            {% endif %}
            <a href="{% url 'booking:logout' %}" class="btn btn-primary">Logout</a>
            {% else %}
            <a href="{% url 'booking:customer_register' %}" class="btn btn-outline">Sign Up</a>
            <a href="{% url 'booking:login' %}" class="btn btn-primary">Sign In</a>
            {% endif %}
        </div>
    </header>

    <!-- NAV -->
    <nav class="nav-bar">
        <ul class="nav-links">
            <li><a href="{% url 'booking:browse' %}">Movies</a></li>
            <li><a href="{% url 'booking:browse' %}?category=events">Events</a></li>
            <li><a href="{% url 'booking:browse' %}?category=sports">Sports</a></li>
        </ul>
    </nav>

    <!-- MAIN -->
    <main class="detail-container">

        <!-- TOP -->
        <section class="detail-top">
            <div class="poster">
                {% if movie.poster %}
                <img src="{{ movie.poster.url }}" alt="{{ movie.title }}">
                {% else %}
                <span style="color:white;">No Poster</span>
                {% endif %}
            </div>

            <div class="movie-info">
                <h1>{{ movie.title }}</h1>

                <div class="meta">
                    <span class="rating">{{ movie.rating|default:"--" }}/10</span>
                    {{ movie.duration }} min • {{ movie.genre.name }}
                </div>

                <div class="meta">
                    {{ movie.certification }} • {{ movie.language.name }}
                </div>

                {% if movie.trailer_url %}
                <a href="{{ movie.trailer_url }}" target="_blank"
                    style="color: var(--primary-color); font-weight: 500;">
                    <i class="fas fa-play-circle"></i> Watch Trailer
                </a>
                {% endif %}

                <button class="book-btn"
                    onclick="document.querySelector('.shows').scrollIntoView({behavior: 'smooth'})">Book
                    Tickets</button>
            </div>
        </section>

        <!-- ABOUT -->
        <section class="section">
            <h2>About the Movie</h2>
            <p>{{ movie.description }}</p>
        </section>



        <!-- SHOWS -->
        <section class="section shows">
            <h2>Available Shows</h2>

            {% if shows %}
            {% regroup shows by show_date as date_list %}
            {% for date in date_list %}
            <div class="date">{{ date.grouper|date:"D, d M" }}</div>

            {% for show in date.list %}
            <div class="show-item">
                <div>
                    <strong>{{ show.screen.theatre.name }}</strong><br>
                    <small>{{ show.screen.name }}</small>
                </div>
                <a href="{% url 'booking:seat_selection' show.id %}">
                    {{ show.show_time|time:"H:i" }}
                </a>
            </div>
            {% endfor %}
            {% endfor %}
            {% else %}
            <p>No shows available.</p>
            {% endif %}
        </section>

    </main>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="{% static 'css/showspere.png' %}" alt="ShowSphere Logo" width="50" height="50"
                    fetchpriority="high" loading="eager">
                ShowSphere
            </div>

            <div class="social-links">
                <a href="https://www.facebook.com" target="_blank" class="social-circle"><i
                        class="fab fa-facebook-f"></i></a>
                <a href="https://www.linkedin.com" target="_blank" class="social-circle"><i
                        class="fab fa-linkedin-in"></i></a>
                <a href="https://www.twitter.com" target="_blank" class="social-circle"><i
                        class="fab fa-twitter"></i></a>
                <a href="https://www.instagram.com" target="_blank" class="social-circle"><i
                        class="fab fa-instagram"></i></a>
            </div>

            <p class="footer-text">
                Copyright {% now "Y" %} @ ShowSphere Entertainment Pvt. Ltd. All Rights Reserved.
                <br><br>
                The content and images used on this site are copyright protected and copyrights vests with the
                respective owners. The usage of the content and images on this website is intended to promote the works
                and endorsement of the artist shall be implied. Unauthorized use is prohibited and punishable by law.
            </p>
        </div>
    </footer>

</body>

</html>